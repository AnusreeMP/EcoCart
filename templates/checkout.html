{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoCart - Checkout</title>

    <link rel="stylesheet" href="{% static 'css/checkout.css' %}">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f1f7f1;
            margin: 0;
            padding: 20px;
        }

        .checkout-container {
            width: 85%;
            margin: auto;
        }

        .section {
            background: #fff;
            margin-bottom: 25px;
            padding: 20px;
            border-left: 4px solid #39b36e;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }

        .section-title {
            margin-bottom: 15px;
            color: #1e7c47;
            font-weight: bold;
        }

        .address-card {
            padding: 10px 15px;
            border: 1px solid #d0e9d6;
            border-radius: 10px;
            background: #f7fff7;
            position: relative;
        }

        .edit-btn {
            position: absolute;
            right: 10px;
            top: 10px;
            color: #1e7c47;
            font-size: 14px;
        }

        .item-card {
            display: flex;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .item-img {
            width: 90px;
            height: 90px;
            border-radius: 10px;
        }

        .item-name {
            font-size: 18px;
            font-weight: bold;
        }

        .item-price {
            color: #1e7c47;
            font-weight: bold;
            margin-top: 5px;
        }

        .payment-option {
            display: block;
            padding: 12px 0;
            font-size: 17px;
            cursor: pointer;
        }

        .payment-box {
            background: #f3faf5;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #27a05a;
        }

        .payment-box input {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            border-radius: 8px;
            border: 1px solid #27a05a;
        }

        .verify-btn {
            background: #27a05a;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            margin-top: 10px;
            cursor: pointer;
            font-weight: bold;
        }

        .summary-box {
            background: #e8f7ed;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .summary-box h3 {
            margin: 0 0 10px;
        }

        .place-order-btn {
            width: 100%;
            background: #39b36e;
            color: #fff;
            padding: 15px;
            font-size: 18px;
            border-radius: 12px;
            border: none;
            margin-top: 20px;
            cursor: pointer;
            font-weight: bold;
        }

        .place-order-btn:hover {
            background: #2d995a;
        }
    </style>
</head>

<body>

    <div class="checkout-container">

        <!-- Address Card -->
        <div class="section">
            <h2 class="section-title">Delivery Address</h2>

            <div class="address-card">
                <p><strong>{{ request.user.username }}</strong></p>
                <p>{{ request.user.phone }}</p>
                <p>{{ request.user.address }}</p>
                <p>{{ request.user.pincode }}</p>

                <a href="/edit-address/" class="edit-btn">Edit</a>
            </div>
        </div>

        <!-- Cart Items Section -->
        <div class="section">
            <h2 class="section-title">Your Items</h2>

            {% for item in cart_items %}
            <div class="item-card">
                <img src="{{ item.product.image.url }}" class="item-img">

                <div>
                    <p class="item-name">{{ item.product.name }}</p>
                    <p class="item-qty">Quantity: {{ item.quantity }}</p>
                    <p class="item-price">₹{{ item.total_price }}</p>
                </div>
            </div>
            {% endfor %}
        </div>

        <!--payment-->
        <h2 class="section-title">Payment Method</h2>

        <form action="{% url 'place_order' %}" method="POST">
            {% csrf_token %}
            <input type="hidden" name="address" value="{{ request.user.address }}">
            <!-- COD -->
            <label class="payment-option">
                <input type="radio" name="payment_method" value="COD" checked>
                Cash on Delivery
            </label>
            <div id="cod-info" class="payment-box">
                <p>Pay when the item is delivered to your address.</p>
            </div>

            <!-- UPI -->
            <label class="payment-option">
                <input type="radio" name="payment_method" value="UPI">
                UPI (Google Pay / PhonePe / Paytm)
            </label>

            <div id="upi-box" class="payment-box" style="display:none;">
                <input type="text" name="upi_id" placeholder="example@upi">
                <button type="button" class="verify-btn">Verify UPI</button>
            </div>

            <!-- Debit / Credit Card -->
            <label class="payment-option">
                <input type="radio" name="payment_method" value="CARD">
                Debit / Credit Card
            </label>

            <div id="card-box" class="payment-box" style="display:none;">
                <input type="text" name="card_number" maxlength="16" placeholder="Card Number">
                <input type="text" name="expiry" maxlength="5" placeholder="MM/YY">
                <input type="password" name="cvv" maxlength="3" placeholder="CVV">
            </div>



            <!-- Order Summary Box -->
            <div class="summary-box">
                <h3>Order Summary</h3>
                <p>Total Items: {{ cart_items.count }}</p>
                <p>Total Amount: <strong>₹{{ total_amount }}</strong></p>
            </div>

            <button class="place-order-btn" type="submit">Place Order</button>

        </form>
    </div>

    </div>

    <script>
        const codInfo = document.getElementById("cod-info");
        const upiBox = document.getElementById("upi-box");
        const cardBox = document.getElementById("card-box");

        const radios = document.querySelectorAll("input[name='payment_method']");

        radios.forEach(radio => {
            radio.addEventListener("change", () => {
                codInfo.style.display = "none";
                upiBox.style.display = "none";
                cardBox.style.display = "none";

                if (radio.value === "COD") {
                    codInfo.style.display = "block";
                }
                else if (radio.value === "UPI") {
                    upiBox.style.display = "block";
                }
                else if (radio.value === "CARD") {
                    cardBox.style.display = "block";
                }
            });
        });


    </script>

</body>

</html>